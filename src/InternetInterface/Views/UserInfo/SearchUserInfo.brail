<head>
<link href="../Styles/style.css" type="text/css" rel="stylesheet" />
<link rel="stylesheet" href="../Styles/base.css" type="text/css" media="screen" />
<!-- <link href="../Styles/base.css" type="text/css" rel="stylesheet" /> --->
<% OutputSubView("""\Subview\MapHead""") %>
<div id="main" style="width: 50%;">
<div id="container">
<div id="block-tables" class="block">
<div class="content">
    <%if not Editing: %>
        <form class="form login" method="post" action="${siteroot}/UserInfo/LoadEditMudule">
    <input type="hidden" name="ClientID" value="${ClientCode}" />
    <input type="hidden" name="EditFlag" value="${Editing}" />
	<table class="table" style="width: 100%;" align="left">
    <thead>
            <%if IsDefined("EditFlag"):
              output  WriteMessageNotice(EditFlag)
        end %>
                <%if IsDefined("Applying"):
               output WriteMessageNotice(Applying)
        end %>
        <th>Информация по клиенту ${Client.Surname}  ${Client.Name}  ${Client.Patronymic}
        <%if PartnerAccessSet.AccesPartner("RC"): %>
         <input id="EditButton" type="submit" value="Редактировать"  align="right" />
         <%end %>
        </th>
    </thead>
    <tbody>
    </form>
		<tr>
            <td><span class="description">Город: </span> ${Client.City}</td>
        </tr>
        <tr>
            <td><span class="description">Адрес подключения: </span>   ${Client.Street} ${Client.House}${Client.CaseHouse} ${Client.Apartment} Подъезд ${Client.Entrance} Этаж ${Client.Floor}</td>
        </tr>
        <tr>
            <td><span class="description">Номер телефона: </span> ${Client.PhoneNumber}</td>
        </tr>
        <%if PartnerAccessSet.AccesPartner("VP"): %>
        <tr>
            <td>Паспортные данные: <br />
                                                 <span class="description">Серия\Номер</span> ${Client.PassportSeries} \ ${Client.PassportNumber}<br />
                                                 <span class="description">Кем выдан: </span> ${Client.WhoGivePassport}<br />
                                                 <span class="description">Адрес регистрации:</span> ${Client.RegistrationAdress}<br />
                                                 <span class="description">Дата выдачи :</span> ${Client.OutputDate}</td>
        </tr>
        <%end %>
        <tr>
            <td><span class="description">Дата регистрации:</span> ${Client.RegDate}</td>
        </tr>
				
		
        <%if Client.HasRegistered != null: %>
            <tr>
                <td><span class="description">Зарегистрировал:</span> ${Client.HasRegistered.Name}</td>
            </tr>
        <%end %>
        <%if Client.Tariff != null: %>
        <tr>
             <td><span class="description">Тариф:</span> ${Client.Tariff.Name}</td>
        </tr>
         <%end %>


        <tr>
            <td><span class="description">Баланс:</span> ${Client.Balance}</td>
        </tr>
        <tr>
            <td><span class="description">Логин:</span> ${Client.Login}</td>
        </tr>
        <tr>
        <%if (Client.HasConnected != null): %>
            <td><span class="description">Назначен бригаде:</span> ${Client.HasConnected.Name}</td>
            <%else: %>
            <td><span class="description"></span> Подключение клиента не назначено</td>
            <%end %>
        </tr>
                <tr>
        <%if Client.Status != null: %>
            <tr>
                <td><span class="description">Статус клиента:</span> ${Client.Status.Name}</td>
            </tr>
        <%end %>
        <%if (Client.Connected): %>
            <td><span class="description">Статус подключения:</span> Подключен</td>
            <%else: %>
            <td><span class="description">Статус подключения:</span>Не подключен</td>
            <%end %>
        </tr>
                <%if IsDefined("RegisntationDate"): %>
		    <tr>
                <td><span class="description">Дата регистрации заявки:</span> ${RegisntationDate}</td>
            </tr>
        <%end %>
		<%if IsDefined("CloseDate"): %>
		<tr>
                <td><span class="description">Дата подключения:</span> ${CloseDate}</td>
        </tr>
        <%end %>
    </tbody>
</table>
    <%else:%>
    <form class="form edit" method="post" action="${siteroot}/UserInfo/EditInformation">
    <input type="hidden" name="ClientID" value="${ClientCode}" />
    <table class="table" style="width:100%; " border="0" id="EditTable"> 
   <% OutputSubView("""\Subview\Client""") %>
               <tr>
               <td >
                  <div class="actions">
                       <button type="submit" id="SaveButton" class="button">
                       <img alt="Save" src="../Images/application_edit.png"> Сохранить
                       </button>
                                <!--    <input class="button" id="RegisterButton" type="submit" value="Зарегистрировать" /></td> -->
                  </div>
               </tr>
    </table>
    </form>
    <%end %>
<br />
<%if PartnerAccessSet.AccesPartner("DHCP"): %>
  <%if Client.Connected: %>
    <%if not EditingConnect: %>
        <form class="formConnect" method="post" action="${siteroot}/UserInfo/LoadEditConnectMudule">
    <input type="hidden" name="ClientID" value="${ClientCode}" />
    <input type="hidden" name="EditConnectFlag" value="${EditingConnect}" />
	<table class="table" style="width: 100%;" align="left">
    <thead>
            <%if IsDefined("EditFlag"):
              output  WriteMessageNotice(EditFlag)
        end %>
                <%if IsDefined("Applying"):
               output WriteMessageNotice(Applying)
        end %>
        <th>Информация по подключению ${Client.Surname}  ${Client.Name}  ${Client.Patronymic}
        <%if PartnerAccessSet.AccesPartner("DHCP"): %>
         <input id="Submit1" type="submit" value="Редактировать"  align="right" />
         <%end %>
        </th>
    </thead>
    <tbody>
        <tr>
          <td>Фиксированный IP</td>
          <td>${ConnectInfo.static_IP}</td>
        </tr>
        <tr>
          <td>Арендованный IP</td>
          <td>${ConnectInfo.Leased_IP}</td>
        </tr>
        <tr>
          <td>Свич</td>
          <td>${ConnectInfo.Swith_adr} (${ConnectInfo.swith_IP})</td>
        </tr>
        <tr>
          <td>Порт</td>
          <td>${ConnectInfo.Port}</td>
        </tr>
                <tr>
          <td>Скорость</td>
          <td>${ConnectInfo.Speed}</td>
        </tr>
    </tbody>
    </table>
    </form>
    <%end %>
  <%end %>
<%end %>
<div style="clear:both;">
<%if (Payments.Length == 0): %>
                  <div class="flash">
                     <div class="message error">
                       <p>Платежи отсутствуют</p>
                     </div>
                  </div>
<%else: %>
<table class="table"  style="width: 100%; font-size: small;" align="left">
    <thead>
        <tr valign="top">
            <th>Платеж зарегистрировал</th>
            <th>Дата оплаты клиентом</th>
            <th>Дата регистрации платежа</th>
            <th>Сумма</th>
        </tr>
    </thead>

    <tbody id="SearchResults" class="HighLightCurrentRow">
    <% for i,item in enumerate(Payments): %>
        <tr id="Row${i}">
        <%if item.Agent != null: %>
            <td>${item.Agent.Name}</td>   
            <%else: %>
            <td></td>
            <%end %>
            <td>${item.PaidOn}</td>
            <td>${item.RecievedOn}</td>
            <td>${item.Sum}</td>
        </tr>
    <% end %>
    </tbody> 

</table>
<%end %>
</div>
<br />
<%if PartnerAccessSet.AccesPartner("CB"): %>
<div style="clear:both;">
<form class="form login" method="post" action="${siteroot}/UserInfo/ChangeBalance">
    <input type="hidden" name="ClientID" value="${ClientCode}" />
    <table class="table">
        <thead>
            <th colspan="3">Пополнить баланс клиента</th>
            
        </thead>
        <tbody>
                <% OutputSubView("""\Subview\Payment""") %>
                <td >
                       <%if IsDefined("thisPay"): %>
                       <% if (thisPay.GetErrorText("Sum") != ""): %>
                                                <div class="flash">
                                                    <div class="message error">
                                                    <p>${thisPay.GetErrorText("Sum")}</p>
                                                    </div>
                                                </div>
                      <%end %>
                      <%end %>
                </td>
             </tr>
        <tr colspan="3">
            <td>
               <button type="submit" id="ChangeBalanceButton" class="button">
                  <img alt="Save" src="../Images/tick.png"> Пополнить баланс
                </button>
            </td>
        </tr>
        </tbody>
    </table>
    </form>
</div>
<%end %>
</div>
</div>
</div>
</form>